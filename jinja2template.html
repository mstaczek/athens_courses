<!DOCTYPE html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!-- Magic table sorting   -->
    <script src="https://cdn.jsdelivr.net/npm/jquery.fancytable/dist/fancyTable.min.js"></script>
</head>
<body>
<h1>Athens Courses: <span id="countOutput">0</span></h1>
<table id="athens_table" class="table table-striped table-bordered">
    <caption>No more courses available</caption>

    <thead class="thead-light">
    <tr>
        {% for column in df.columns[:-1] %} <!-- last column is Link-->
            <th>{{ column }}</th>
        {% endfor %}
    </tr>
    </thead>
    <tbody class="table-hover">

    {% for idx, row in df.iterrows() %}
    <tr>
        {% for colname in df.columns %}
            {% if 'Link' != colname %}
            <td>
                <div class="maxed">
                    {{ row[colname]}}
                    {% if 'Code' == colname %}
                        <a href="{{row.Link}}">Course page</a>
                    {% endif %}
                </div>
            </td>
            {% endif %}
        {% endfor %}
    </tr>
    {% endfor %}
    </tbody>

</table>
<script>
$("#athens_table").fancyTable({
  sortable: true,
});
</script>
<script>
        // Select the node that will be observed for mutations
        const targetNode = document.getElementById("athens_table").children[2];
        const contOutput = document.getElementById("countOutput");

        function updateCount(){
            let visible_rows_count = 0;
            for(let child of targetNode.children){
                visible_rows_count += 1 - child.attributeStyleMap.size
            }
            contOutput.innerHTML = visible_rows_count;
        }

        // Options for the observer (which mutations to observe)
        let config = { attributes: true, childList: true, subtree: true };

        // Callback function to execute when mutations are observed
        let callback = function(mutationsList, observer) {
            updateCount();
        };

        // Create an observer instance linked to the callback function
        let observer = new MutationObserver(callback);

        // Start observing the target node for configured mutations
        observer.observe(targetNode, config);
        updateCount();

</script>
<style>
        h1 {
          margin: 30px 30px 20px 30px;
        }
        table {
            margin: 0px 30px 20px 30px;
        }
        .maxed{
           max-height:200px;
           overflow:hidden;
        }
        .maxed:hover{
        overflow-y: scroll;
        }

</style>
</body>



